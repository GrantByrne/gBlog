@page "/admin/Posts"
@inject BlogDbContext DbContext

@using Blog.Web.Pages.Shared
@using Blog.Web.Database
@using Blog.Web.Models
@layout AdminLayout

<h3>Posts</h3>

<div class="card">
    <div class="card-header">
        <a class="btn btn-primary float-end" href="/admin/createpost">Create Post</a>
    </div>
    <div class="card-body px-0">
        <table class="table table-striped table-hover m-0">
            <thead>
            <th>Title</th>
            <th>Published</th>
            <th></th>
            </thead>
            <tbody>
            @foreach (var post in PostItems)
            {
                <tr>
                    <td>
                        <a href="admin/EditPost">
                            @post.Title[..Math.Min(100, post.Title.Length)]
                        </a>
                    </td>
                    <td>@post.Created.ToShortDateString()</td>
                    <td>Actions</td>
                </tr>
            }
            </tbody>
        </table>
    </div>
    <div class="card-footer">
        <a class="btn btn-primary" href="#">Newer</a>
        <a class="btn btn-primary float-end" href="#">Older</a>
    </div>
</div>

@code {

    private List<Post> PostItems { get; set; } = new();
    
    protected override void OnInitialized()
    {
        PostItems = DbContext.Posts
            .OrderBy(p => p.Created)
            .Take(10)
            .ToList();
    }

}